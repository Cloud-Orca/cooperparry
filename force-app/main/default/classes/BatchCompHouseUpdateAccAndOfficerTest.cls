@IsTest
public with sharing class BatchCompHouseUpdateAccAndOfficerTest {
    
    public class API_ResponseMock implements HttpCalloutMock {
        public HTTPResponse respond(HTTPRequest request) {
            System.debug('ENDPOINT: ' + request.getEndPoint());
            String insertBody = '';
            if(request.getEndPoint() == 'https://api.company-information.service.gov.uk//company/11354151'){
                insertBody = '{"links":{"filing_history":"/company/11354151/filing-history","persons_with_significant_control":"/company/11354151/persons-with-significant-control","self":"/company/11354151","officers":"/company/11354151/officers"},"company_name":"CLOUD ORCA LIMITED","sic_codes":["62012","62020","62030","63110"],"company_number":"11354151","confirmation_statement":{"overdue":false,"next_made_up_to":"2024-02-03","last_made_up_to":"2023-02-03","next_due":"2024-02-17"},"company_status":"active","has_insolvency_history":false,"undeliverable_registered_office_address":false,"registered_office_is_in_dispute":false,"type":"ltd","jurisdiction":"england-wales","accounts":{"accounting_reference_date":{"month":"05","day":"31"},"next_due":"2024-02-29","next_made_up_to":"2023-05-31","overdue":false,"last_accounts":{"made_up_to":"2022-05-31","period_end_on":"2022-05-31","type":"total-exemption-full","period_start_on":"2021-06-01"},"next_accounts":{"period_end_on":"2023-05-31","due_on":"2024-02-29","period_start_on":"2022-06-01","overdue":false}},"has_charges":false,"registered_office_address":{"postal_code":"EC2A 1NT","address_line_1":"131 Finsbury Pavement","country":"England","locality":"London"},"date_of_creation":"2018-05-10","etag":"8bf9ff63002604557059be9cf07f78c9cd8a5ab5","has_super_secure_pscs":false,"can_file":true}';
            } else if(request.getEndPoint() == 'https://api.company-information.service.gov.uk//company/COMPHOUSEID123/persons-with-significant-control'){
                insertBody = '{"items":[{"etag":"12345", "ceased":false},{"etag":"12346", "ceased":false}]}';
            } else if(request.getEndPoint() == 'https://api.company-information.service.gov.uk//search/companies?q=CLOUD+ORCA+LIMITED'){
                insertBody = '{"start_index":0,"kind":"search#companies","items":[{"company_status":"active","title":"CLOUD ORCA LIMITED","company_number":"11354151","address_snippet":"131 Finsbury Pavement, London, England, EC2A 1NT","links":{"self":"/company/11354151"},"kind":"searchresults#company","description":"11354151 - Incorporated on 10 May 2018","date_of_creation":"2018-05-10","snippet":"","address":{"postal_code":"EC2A 1NT","premises":"131","locality":"London","address_line_1":"Finsbury Pavement","country":"England"},"matches":{"snippet":[],"title":[1,5,7,10]},"company_type":"ltd","description_identifier":["incorporated-on"]},{"description":"OE007600 - Registered on 13 December 2022","kind":"searchresults#company","date_of_creation":"2022-12-13","address_snippet":"Les Echelons Court, Les Echelons, St. Peter Port, Guernsey, GY1 1AR","links":{"self":"/company/OE007600"},"title":"ORCA INVESTMENTS (BRISTOL) LIMITED","company_number":"OE007600","company_status":"registered","external_registration_number":"38524","address":{"locality":"St. Peter Port","region":"Guernsey","postal_code":"GY1 1AR","premises":"Les Echelons Court","address_line_1":"Les Echelons"},"snippet":"","description_identifier":[null,"registered"],"company_type":"registered-overseas-entity","matches":{"snippet":[],"title":[1,4]}}],"items_per_page":20,"total_results":12025,"page_number":1}';
            } else if(request.getEndPoint() == 'https://api.company-information.service.gov.uk//company/11354151/officers'){
                insertBody = '{"total_results":5,"resigned_count":1,"active_count":4,"items_per_page":35,"items":[{"appointed_on":"2022-08-18","links":{"self":"/company/11354151/appointments/k7wrrp707KW2pwzvIZd20BxEfUU","officer":{"appointments":"/officers/jP2mj6wU6QM_Kutnks1murgGXoQ/appointments"}},"date_of_birth":{"month":1,"year":1990},"nationality":"British","address":{"country":"England","address_line_1":"Finsbury Pavement","locality":"London","premises":"131","postal_code":"EC2A 1NT"},"country_of_residence":"England","occupation":"Delivery Director","officer_role":"director","name":"BELLAMY, Luke James"},{"country_of_residence":"United Kingdom","occupation":"Director","address":{"premises":"131","address_line_1":"Finsbury Pavement","country":"England","locality":"London","postal_code":"EC2A 1NT"},"officer_role":"director","name":"DI CARLO, Antonio","nationality":"British","date_of_birth":{"month":9,"year":1984},"links":{"self":"/company/11354151/appointments/0psciyuLrvOSAc8wXFvH-7_AR4c","officer":{"appointments":"/officers/_O5iiFxN50xCaY6M35HyHNXnZis/appointments"}},"appointed_on":"2019-03-18"},{"links":{"self":"/company/11354151/appointments/Jb9xK9RohctrUBIXRkYh2khpTK0","officer":{"appointments":"/officers/9BlH2R6WLoI_G5-TN5wZY_mtRac/appointments"}},"appointed_on":"2021-07-29","address":{"address_line_1":"Finsbury Pavement","postal_code":"EC2A 1NT","locality":"London","premises":"131","country":"England"},"country_of_residence":"England","occupation":"Director","officer_role":"director","name":"MCCARTHY, Ben","date_of_birth":{"month":7,"year":1990},"nationality":"English"},{"links":{"self":"/company/11354151/appointments/IaLvrulqOl03m8TkNGRkmSyyFe8","officer":{"appointments":"/officers/BsgcLb-ABHMTN1sVnEbvPzW4ZBw/appointments"}},"appointed_on":"2018-05-10","address":{"locality":"London","address_line_1":"Finsbury Pavement","country":"England","postal_code":"EC2A 1NT","premises":"131"},"country_of_residence":"England","occupation":"Director","name":"ROWLAND, Edward James","officer_role":"director","date_of_birth":{"year":1984,"month":12},"nationality":"British"},{"resigned_on":"2020-09-17","appointed_on":"2018-05-10","links":{"officer":{"appointments":"/officers/eQkgnIBz6vHWJoU17cnlOserdWU/appointments"},"self":"/company/11354151/appointments/lBVs69-qrAzkM846X1o-BJpv1lQ"},"date_of_birth":{"year":1985,"month":2},"nationality":"British","address":{"address_line_1":"Luke Street","region":"London","locality":"Shoreditch","premises":"25","postal_code":"EC2A 4DS","country":"England"},"country_of_residence":"United Kingdom","occupation":"Director","name":"AKANDE, Olu Dare","officer_role":"director"}],"etag":"215386f7535b77b87593a674fb5c639e39b724dd","inactive_count":0,"links":{"self":"/company/11354151/officers"},"start_index":0,"kind":"officer-list"}';
            } else if(request.getEndPoint() == 'https://api.company-information.service.gov.uk//company/11354151/filing-history'){
                insertBody = '{"items":[{"action_date":"2023-10-30","category":"capital","date":"2023-11-01","description":"capital-allotment-shares","description_values":{"date":"2023-10-30","capital":[{"currency":"GBP","figure":"66.56"}]},"links":{"self":"/company/11354151/filing-history/MzM5ODY1OTMxNGFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/WNB07PoOY4EvnixYPC0iyGIcPy-w46o3U_f_hkBbTWs"},"type":"SH01","pages":4,"barcode":"XCFEOWKY","transaction_id":"MzM5ODY1OTMxNGFkaXF6a2N4"},{"action_date":"2023-07-12","category":"capital","date":"2023-07-18","description":"capital-allotment-shares","description_values":{"capital":[{"figure":"65.97","currency":"GBP"}],"date":"2023-07-12"},"links":{"self":"/company/11354151/filing-history/MzM4Njc0NDI4M2FkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/H5vlHFanhe0IgLI4wYW1WWbxwfNGn7ALMyLTKHjbVKw"},"type":"SH01","pages":4,"barcode":"XC80F00Y","transaction_id":"MzM4Njc0NDI4M2FkaXF6a2N4"},{"category":"resolution","date":"2023-06-21","description":"resolution","description_values":{"description":"Resolutions"},"links":{"self":"/company/11354151/filing-history/WUM1QlFSWVphZGlxemtjeA","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/pNPSqGHk2N0tFsldv1leNPIvCDPjbSGGNcw2BBO4ozw"},"paper_filed":true,"resolutions":[{"category":"capital","description":"resolution-securities","subcategory":"resolution","type":"RES10"},{"category":"capital","description":"resolution-removal-pre-emption","subcategory":"resolution","type":"RES11"},{"category":"capital","description":"resolution","description_values":{"description":"Option agreements 30/05/2023"},"subcategory":"resolution","type":"RES13"}],"type":"RESOLUTIONS","pages":2,"barcode":null,"transaction_id":"WUM1QlFSWVphZGlxemtjeA"},{"action_date":"2023-05-30","category":"capital","date":"2023-06-09","description":"capital-allotment-shares","description_values":{"date":"2023-05-30","capital":[{"figure":"64.5","currency":"GBP"}]},"links":{"self":"/company/11354151/filing-history/MzM4MjQ1Mjg4NmFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/pH-VYg51HIePqw_D_wSanaSR6pd3d8C_9WAc-TFBLxQ"},"type":"SH01","pages":4,"barcode":"XC5BQQCY","transaction_id":"MzM4MjQ1Mjg4NmFkaXF6a2N4"},{"action_date":"2023-02-03","category":"confirmation-statement","date":"2023-03-21","description":"confirmation-statement-with-updates","description_values":{"made_up_date":"2023-02-03"},"links":{"self":"/company/11354151/filing-history/MzM3MzQ0NTM4OWFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/5WO7zQGtV1MmQWi4eiTNH7yECxM1Li8lyGrBZhgH0q0"},"type":"CS01","pages":6,"barcode":"XBZSN4H4","transaction_id":"MzM3MzQ0NTM4OWFkaXF6a2N4"},{"action_date":"2023-01-28","category":"officers","date":"2023-01-31","description":"change-person-director-company-with-change-date","description_values":{"change_date":"2023-01-28","officer_name":"Antonio Di Carlo"},"links":{"self":"/company/11354151/filing-history/MzM2NzcwNDkyMmFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/QDkbrRHmnnBmU4XiZJPTZGzU-rwDq7igMkt76t2Zeg0"},"subcategory":"change","type":"CH01","pages":2,"barcode":"XBWCMU0X","transaction_id":"MzM2NzcwNDkyMmFkaXF6a2N4"},{"action_date":"2023-01-31","category":"address","date":"2023-01-31","description":"change-registered-office-address-company-with-date-old-address-new-address","description_values":{"new_address":"131 Finsbury Pavement London EC2A 1NT","change_date":"2023-01-31","old_address":"120 Moorgate London EC2M 6UR England"},"links":{"self":"/company/11354151/filing-history/MzM2NzcwMzUzOWFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/1Cv21OtCIArod8UkVuIwi24kxves3yl3kfTlzYDxB_8"},"type":"AD01","pages":1,"barcode":"XBWCMO2J","transaction_id":"MzM2NzcwMzUzOWFkaXF6a2N4"},{"action_date":"2023-01-05","category":"address","date":"2023-01-05","description":"change-registered-office-address-company-with-date-old-address-new-address","description_values":{"old_address":"35 New Bond Street New Broad Street House London EC2M 1NH England","new_address":"120 Moorgate London EC2M 6UR","change_date":"2023-01-05"},"links":{"self":"/company/11354151/filing-history/MzM2NDc3MjUxNmFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/iVdIZD9eaXvFnakrMeRUD1bGagrC8wycrO12l2Sm7zA"},"type":"AD01","pages":1,"barcode":"XBUKFEH4","transaction_id":"MzM2NDc3MjUxNmFkaXF6a2N4"},{"action_date":"2021-05-21","category":"officers","date":"2022-12-13","description":"change-person-director-company-with-change-date","description_values":{"officer_name":"Mr Edward James Rowland","change_date":"2021-05-21"},"links":{"self":"/company/11354151/filing-history/MzM2MTk1Mzc1N2FkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/363-2vHftybS1wqcY6XubjC5BNqAs8hVlY2S_J9MINg"},"subcategory":"change","type":"CH01","pages":2,"barcode":"XBISSO1K","transaction_id":"MzM2MTk1Mzc1N2FkaXF6a2N4"},{"action_date":"2022-05-31","category":"accounts","date":"2022-12-12","description":"accounts-with-accounts-type-total-exemption-full","description_values":{"made_up_date":"2022-05-31"},"links":{"self":"/company/11354151/filing-history/MzM2MTc0NjIzM2FkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/R3G952BPwOpcRpj1w7YzlzByqUdAIVnyCBRces7c3Ko"},"type":"AA","pages":9,"barcode":"XBIPWGEY","transaction_id":"MzM2MTc0NjIzM2FkaXF6a2N4"},{"action_date":"2022-09-14","category":"capital","date":"2022-09-14","description":"capital-allotment-shares","description_values":{"capital":[{"currency":"GBP","figure":"64.25"}],"date":"2022-09-14"},"links":{"self":"/company/11354151/filing-history/MzM1MTg0NTc3NWFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/pDAaHmsnKZ16YMYX7cuyEG76BV91svohNIpnkjVEGJM"},"type":"SH01","pages":4,"barcode":"XBCIXGNN","transaction_id":"MzM1MTg0NTc3NWFkaXF6a2N4"},{"action_date":"2022-08-31","category":"capital","date":"2022-09-01","description":"capital-allotment-shares","description_values":{"date":"2022-08-31","capital":[{"currency":"GBP","figure":"63.85"}]},"links":{"self":"/company/11354151/filing-history/MzM1MDQ4OTk2MmFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/dphq7KpEvvRJm0Q8LDLglJ7x4cvxtXOErcvD0ute0oY"},"type":"SH01","pages":4,"barcode":"XBBMZQAP","transaction_id":"MzM1MDQ4OTk2MmFkaXF6a2N4"},{"action_date":"2022-08-18","category":"officers","date":"2022-08-18","description":"appoint-person-director-company-with-name-date","description_values":{"officer_name":"Mr Luke James Bellamy","appointment_date":"2022-08-18"},"links":{"self":"/company/11354151/filing-history/MzM0OTA0ODQ4OWFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/o5OfVvm7pk_f0SmeOhem8FdlgD9uAGMVxoWwSLBRv8s"},"subcategory":"appointments","type":"AP01","pages":2,"barcode":"XBAO9I5T","transaction_id":"MzM0OTA0ODQ4OWFkaXF6a2N4"},{"category":"resolution","date":"2022-08-08","description":"resolution","description_values":{"description":"Resolutions"},"links":{"self":"/company/11354151/filing-history/WUI5TjFOS09hZGlxemtjeA","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/0wt9k6GUzL1CFV88u9nqCuWqOOEcyP5HxLtuXl1Vy7I"},"paper_filed":true,"resolutions":[{"category":"incorporation","description":"resolution-adopt-articles","description_values":{"res_type":"ADOPT ARTICLES"},"subcategory":"resolution","type":"RES01"}],"type":"RESOLUTIONS","pages":2,"barcode":null,"transaction_id":"WUI5TjFOS09hZGlxemtjeA"},{"category":"incorporation","date":"2022-08-08","description":"memorandum-articles","links":{"self":"/company/11354151/filing-history/MzM0NzcwOTE5NmFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/H0HWdHfAmT3-Nys7xw1ntt2n1GZ1Zw2T64yS2rwzefQ"},"paper_filed":true,"type":"MA","pages":12,"barcode":"YB9N1ND7","transaction_id":"MzM0NzcwOTE5NmFkaXF6a2N4"},{"action_date":"2022-07-27","category":"address","date":"2022-07-27","description":"change-registered-office-address-company-with-date-old-address-new-address","description_values":{"old_address":"35 New Broad Street New Broad Street House London EC2M 1NH England","new_address":"35 New Bond Street New Broad Street House London EC2M 1NH","change_date":"2022-07-27"},"links":{"self":"/company/11354151/filing-history/MzM0Njk2NDkwNWFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/RMnRz1EcC_386aPxlk07FSsLVKNBUyhI5gIGxHJfGRQ"},"type":"AD01","pages":1,"barcode":"XB949Y22","transaction_id":"MzM0Njk2NDkwNWFkaXF6a2N4"},{"action_date":"2022-07-01","category":"persons-with-significant-control","date":"2022-07-22","description":"change-to-a-person-with-significant-control","description_values":{"psc_name":"Mr Antonio Di Carlo","change_date":"2022-07-01"},"links":{"self":"/company/11354151/filing-history/MzM0NjM3NDY2NGFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/O0acvBxy6HeUgiIigFgh5V8vmes94VxFz3aGHfBg4zY"},"subcategory":"change","type":"PSC04","pages":2,"barcode":"XB8QSSHV","transaction_id":"MzM0NjM3NDY2NGFkaXF6a2N4"},{"action_date":"2022-07-20","category":"officers","date":"2022-07-21","description":"change-person-director-company-with-change-date","description_values":{"change_date":"2022-07-20","officer_name":"Antonio Di Carlo"},"links":{"self":"/company/11354151/filing-history/MzM0NjM3NTU0MGFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/TtSC2kU7U4aXahDthji3qKG2n2_AIpTPhiBy_owoyoY"},"subcategory":"change","type":"CH01","pages":2,"barcode":"XB8QSVPF","transaction_id":"MzM0NjM3NTU0MGFkaXF6a2N4"},{"action_date":"2022-07-01","category":"persons-with-significant-control","date":"2022-07-21","description":"change-to-a-person-with-significant-control","description_values":{"psc_name":"Mr Antonio Di Carlo","change_date":"2022-07-01"},"links":{"self":"/company/11354151/filing-history/MzM0NjM3NDAwOGFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/4Bb-9OP-ZEfXX6vVHn4F12HQqFsaVWcLHcqtgJvf_OQ"},"subcategory":"change","type":"PSC04","pages":2,"barcode":"XB8QSQ9N","transaction_id":"MzM0NjM3NDAwOGFkaXF6a2N4"},{"action_date":"2022-07-21","category":"address","date":"2022-07-21","description":"change-registered-office-address-company-with-date-old-address-new-address","description_values":{"new_address":"35 New Broad Street New Broad Street House London EC2M 1NH","change_date":"2022-07-21","old_address":"25 Luke Street Shoreditch London EC2A 4DS England"},"links":{"self":"/company/11354151/filing-history/MzM0NjM3MzY0M2FkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/YwlF23EZTFLOd0hobI4f-E8MIDNRdJKUNu_a4zD_DIE"},"type":"AD01","pages":1,"barcode":"XB8QSOXL","transaction_id":"MzM0NjM3MzY0M2FkaXF6a2N4"},{"action_date":"2022-07-20","category":"capital","date":"2022-07-21","description":"capital-allotment-shares","description_values":{"date":"2022-07-20","capital":[{"figure":"63.6","currency":"GBP"}]},"links":{"self":"/company/11354151/filing-history/MzM0NjM0ODYwMGFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/0hx1UFkIY8BGyY6pZTtFrLaNFSVZL9YtACBMTS-LncI"},"type":"SH01","pages":4,"barcode":"XB8QPUZV","transaction_id":"MzM0NjM0ODYwMGFkaXF6a2N4"},{"action_date":"2022-02-28","category":"capital","date":"2022-02-28","description":"capital-allotment-shares","description_values":{"date":"2022-02-28","capital":[{"figure":"63.45","currency":"GBP"}]},"links":{"self":"/company/11354151/filing-history/MzMzMTI5OTUyM2FkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/1R8hczJsBDpfD6EoeTWBOUdm0OpjIFMNarUDaViJcEU"},"type":"SH01","pages":4,"barcode":"XAYTC8VF","transaction_id":"MzMzMTI5OTUyM2FkaXF6a2N4"},{"action_date":"2022-02-03","category":"confirmation-statement","date":"2022-02-21","description":"confirmation-statement-with-updates","description_values":{"made_up_date":"2022-02-03"},"links":{"self":"/company/11354151/filing-history/MzMzMDQ2NDkzMWFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/kzk4spBk5Ek6u6nDWqa5bm-Xk-i1iLf9VidhN0UGiW0"},"type":"CS01","pages":6,"barcode":"XAYAJ7QP","transaction_id":"MzMzMDQ2NDkzMWFkaXF6a2N4"},{"action_date":"2021-05-31","category":"accounts","date":"2021-12-13","description":"accounts-with-accounts-type-total-exemption-full","description_values":{"made_up_date":"2021-05-31"},"links":{"self":"/company/11354151/filing-history/MzMyMzQxOTg3MWFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/EDImx9agtx7F3Pyce75jlYDt9z-DfN7U93sR0GuMIMc"},"type":"AA","pages":8,"barcode":"XAJ9AF75","transaction_id":"MzMyMzQxOTg3MWFkaXF6a2N4"},{"action_date":"2021-11-15","category":"capital","date":"2021-11-15","description":"capital-allotment-shares","description_values":{"date":"2021-11-15","capital":[{"figure":"63.35","currency":"GBP"}]},"links":{"self":"/company/11354151/filing-history/MzMyMDIwODI3NmFkaXF6a2N4","document_metadata":"https://frontend-doc-api.company-information.service.gov.uk/document/SU-OrccSytAXhmFltw672e3ZJfAiLA9WRf9-J0wQ2Ik"},"type":"SH01","pages":4,"barcode":"XAHBJJVN","transaction_id":"MzMyMDIwODI3NmFkaXF6a2N4"}]}';
            } else {
                insertBody = '{"error": "Unexpected endpoint"}';
            }

            HttpResponse response = new HttpResponse();
            response.setHeader('Content-Type', 'application/json');
            response.setBody(insertBody);
            response.setStatus('OK');
            response.setStatusCode(200);
            System.debug('response::' + response);
            return response;
        }
    }

    @TestSetup
    static void setup(){
        Company_House_API__c testAPISettings = new Company_House_API__c(
            CompanyEndPoint__c = 'https://api.company-information.service.gov.uk/',
            Authorization__c = '774eb80a-826a-4d1f-aaab-667a92bf2c0d'
        );
        insert testAPISettings;

        Company_House_Setting__c addressSettings = new Company_House_Setting__c(
            Account_Address__c = 'Billing',
            Contact_Address__c = 'Mailing',
            Auto_Update_Accounts__c = true,
            Auto_Update_Contacts__c = true
        );
        insert addressSettings;

    }      

    @isTest
    public static void testBatchClass() {
        Test.setMock(HttpCalloutMock.class, new API_ResponseMock());

        List<Account> accountList = new List<Account>();
        for (Integer i=0; i<1; i++) {
            accountList.add(new Account(
                            Name = 'CLOUD ORCA LIMITED ' + i,
                            Company_Legal_Name__c = 'CLOUD ORCA LIMITED', 
                            Company_registration_number__c = '11354151',
                            Beauhurst_ID__c = '11354151',
                            Companies_House_Id__c = 'COMPHOUSEID123',
                            Source__c = 'Inbound',
                            Source_Type__c = 'Website'
                        )
            );
        }
        insert accountList;
        System.debug('accountList::' + accountList);

        List<Officer__c> contactList = new List<Officer__c>();
        for (Account account : accountList) {
            System.debug('account::' + account);
            contactList.add(new Officer__c(
                            Last_Name__c = 'Officer ' + account.Name,
                            Account__c = account.id,
                            Occupation__c = 'Delivery Director',
                            Officer_Role__c = 'director',
                            Officer_Key__c = '123456789'
                        )
            );
        }
        insert contactList;
        System.debug('contactList::' + contactList);

        Test.startTest();
            // Database.SaveResult []str = Database.insert(accountList,false);
            // system.assertEquals(false, str[0].isSuccess());

            BatchCompHouseUpdateAccAndOfficer batch = new BatchCompHouseUpdateAccAndOfficer(new List<String>());
            Database.executeBatch(batch);
        Test.stopTest();
        System.assertEquals(1, [SELECT Count() FROM Account WHERE Beauhurst_ID__c = '11354151']);
    }
}